<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <center>
        <h1>简单考试示例</h1>
        <div><span>考试时间:</span><span id="btn"></span></div>
    </center>
    <script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
    <!--提交试题的答案并保存-->
    <script type="text/javascript">
        $(document).ready(function() {
            $("#p3").click(function() {
                var obj = {
                    "user_id": Request['user_id'],
                    "examination_id": $("#p4").val(),
                    "answer_content": $("#p2").val()
                };
                console.log(obj.answer_content);
                console.log(obj.examination_id);
                if (obj.answer_content != "" && obj.examination_id != "") {
                    $.ajax({
                        type: "post",
                        url: "http://192.168.30.234:8080/insertAnswer",
                        contentType: "application/json; charset=utf-8",
                        dataType: "text",
                        data: JSON.stringify(obj),
                        success: function(response) {
                            console.log(response);
                            alert(response);

                        },
                        error: function() {}
                    });
                } else if (obj.answer_content == "") {
                    console.log("答案不能为空");
                    alert("答案不能为空");
                } else if (obj.examination_id == "") {
                    console.log("请选择题目再提交");
                    alert("请选择题目再提交保存");
                }

            });
        });

    </script>

    <!--点击题目得到试题信息-->
    <script type="text/javascript">
        function getvalue(value) {
            var obj = {
                "user_id": Request['user_id'],
                "exam_id": value
            };
            $.ajax({
                type: "post",
                url: "http://192.168.30.234:8080/getExamAndAnswer",
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify(obj),
                success: function(Message) {
                    console.dir(Message);
                    if (Message.answer_content == "") {
                        $("#p1").text(Message.examination_id + "、" + Message.examination_question + "(" + Message.examination_score + "分)");
                        $("#p2").text('');
                    } else {
                        $("#p1").text(Message.examination_id + "、" + Message.examination_question + "(" + Message.examination_score + "分)");
                        $("#p2").text(Message.answer_content);
                    }
                },
                error: function() {}
            });
        }

    </script>
    <!--获取页面传过来的用户id-->
    <script type="text/javascript">
        function GetUrlRequest() {
            var url = location.search; //获取url中"?"符后的字串
            console.log(url);
            var theRequest = new Object();
            if (url.indexOf("?") != -1) {
                var str = url.substr(1);
                if (str.indexOf("&") != -1) {
                    strs = str.split("&");
                    for (var i = 0; i < strs.length; i++) {
                        theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
                    }
                } else {
                    theRequest[str.split("=")[0]] = unescape(str.split("=")[1]);
                }
            }
            return theRequest;
        }
        var Request = new Object();
        Request = GetUrlRequest();
        var user_id = Request['user_id'];
        console.log(user_id);

    </script>
    <!--    计时器设定-->
    <script>
        var x = 30,
            interval;
        window.onload = function() {
            var d = new Date("1111/1/1,0:" + x + ":0");
            interval = setInterval(function() {
                var m = d.getMinutes();
                var s = d.getSeconds();
                m = m < 10 ? "0" + m : m;
                s = s < 10 ? "0" + s : s;
                btn.innerHTML = m + ":" + s;
                if (m == 0 && s == 0) {
                    clearInterval(interval);
                    $("#p5").attr('disabled', 'true');
                    alert("时间到您已不能提交即将退出");
                    window.location.href = "index.html";
                    return;
                }
                d.setSeconds(s - 1);
            }, 1000);
        }

    </script>
    <!--   提交用户表明已做过试题 -->
    <script type="text/javascript">
        $(document).ready(function() {
            $("#p5").click(function() {
                var obj = {
                    "user_id": Request['user_id']
                };
                $.ajax({
                    type: "post",
                    url: "http://192.168.30.234:8080/commit",
                    contentType: "application/json; charset=utf-8",
                    dataType: "text",
                    data: JSON.stringify(obj),
                    success: function(response) {
                        console.log(response);
                        alert(response);
                    },
                    error: function() {}
                });
            });
        });

    </script>
</head>
<style>
    button {
        BORDER-RIGHT: #ffffff 1px solid;
        BORDER-TOP: #ffffff 1px solid;
        FONT-SIZE: 20px;
        BORDER-LEFT: #ffffff 1px solid;
        COLOR: #ffffff;
        BORDER-BOTTOM: #ffffff 1px solid;
        FONT-FAMILY: "宋体", "Verdana";
        BACKGROUND-COLOR: #2D618D
    }
    
    TEXTAREA {
        FONT-SIZE: 14px;
        FONT-FAMILY: "宋体", "Tahoma" BORDER-BOTTOM: #999999 1px ridge;
        BORDER-LEFT: #999999 1px ridge;
        BORDER-RIGHT: #999999 1px ridge;
        BORDER-TOP: #999999 1px ridge;
        size="40"
    }

</style>

<body background="http://sc.zolsky.com/img688877808965/tupian/beijingtupian/beijingtupiandanya_gq/zolsky_bjtpdy_65b.jpg">
    <fieldset style="height:500px;">
        <div style="height:597.031px;width:200px;float:left;">
            <button type="button" id="NO1" value="1" onclick="return getvalue(this.value)">第一题</button><br/><br/>
            <button type="button" id="NO2" value="2" onclick="return getvalue(this.value)">第二题</button><br/><br/>
            <button type="button" id="NO3" value="3" onclick="return getvalue(this.value)">第三题</button><br/><br/>
            <button type="button" id="NO4" value="4" onclick="return getvalue(this.value)">第四题</button><br/><br/>
            <button type="button" id="NO5" value="5" onclick="return getvalue(this.value)">第五题</button><br/><br/>
            <button type="button" id="NO6" value="6" onclick="return getvalue(this.value)">第六题</button><br/><br/>
        </div>
        <div style="height:597.031px;width:900px;float:right;margin-top:100px;">
            <p id="p1">
            </p>
            <p>
                <textarea type="text" id="p2" name="answer" cols=40 rows=8 placeholder="请输入你的答案" /autofocus></textarea>
            </p>
            <br/><br/>
            <p>
                第<input type="number" name="quantity" min="1" max="20" id="p4">题
                <button type="button" id="p3">保存</button><br/><br/><br/>
                <center><button type="button" id="p5">提交</button></center>
            </p>
        </div>
    </fieldset>
</body>

</html>
